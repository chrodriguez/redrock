<h2>Crea tu cuenta</h2>

<%
  if ["fan", "artist"].include? params[:users][:user_type].downcase
    child_class_name = params[:users][:user_type].downcase.camelize
    user_type = params[:users][:user_type].downcase
  else
    child_class_name = "Customer"
    user_type = "customer"
  end

  resource.profile = child_class_name.constantize.new if resource.profile.nil?

%>

<%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name), method: :post, defaults: { input_html: { class: 'form-control' }}) do |f| %>
  <% if resource.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(resource.errors.count, "error") %> prohibited this fan from being saved:</h2>

      <ul>
        <% resource.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

    <%= f.input :email, autofocus: true, input_html: { autocomplete: "email" }%>
    <%= f.input :username  %>
    <%= f.input :password, hint: ("#{@minimum_password_length} characters minimum" if @minimum_password_length),
                input_html: { autocomplete: "new-password" } %>
    <%= f.input :password_confirmation, input_html: { autocomplete: "new-password" } %>

    <%= f.simple_fields_for resource.profile do |p| %>
      <% render :partial => "#{child_class_name.underscore}_fields", :locals => { :f => p } %>
    <% end %>

    <%= f.hidden_field :user_type, :value => user_type %>

    <div class="actions">
      <%= f.submit "Registrarse" %>
    </div>

<% end %>

<%= render "devise/shared/links" %>
